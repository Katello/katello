-# This view contains several lines that are commented (i.e. -#) out on purpose... They may be uncommented when package
-# updates are supported.

= javascript do
  :javascript
    localize({
      "adding_package"            : '#{adding_package}',
      "adding_package_success"    : '#{_('Add Package Completed')}',
      "adding_package_failed"     : '#{_('Add Package Failed')}',
      "adding_package_canceled"   : '#{_('Add Package Canceled')}',
      "adding_package_timeout"    : '#{_('Add Package Timeout')}',

      "updating_package"          : '#{updating_package}',
      "updating_package_success"  : '#{_('Update Package Completed')}',
      "updating_package_failed"   : '#{_('Update Package Failed')}',
      "updating_package_canceled" : '#{_('Update Package Canceled')}',
      "updating_package_timeout"  : '#{_('Update Package Timeout')}',

      "removing_package"          : '#{removing_package}',
      "removing_package_success"  : '#{_('Remove Package Completed')}',
      "removing_package_failed"   : '#{_('Remove Package Failed')}',
      "removing_package_canceled" : '#{_('Remove Package Canceled')}',
      "removing_package_timeout"  : '#{_('Remove Package Timeout')}',

      "adding_group"              : '#{adding_package_group}',
      "adding_group_success"      : '#{_('Add Package Group Completed')}',
      "adding_group_failed"       : '#{_('Add Package Group Failed')}',
      "adding_group_canceled"     : '#{_('Add Package Group Canceled')}',
      "adding_group_timeout"      : '#{_('Add Package Group Timeout')}',

      "removing_group"            : '#{removing_package_group}',
      "removing_group_success"    : '#{_('Remove Package Group Completed')}',
      "removing_group_failed"     : '#{_('Remove Package Group Failed')}',
      "removing_group_canceled"   : '#{_('Remove Package Group Canceled')}',
      "removing_group_timeout"    : '#{_('Remove Package Group Timeout')}',
      
      "validation_error_name_format" : '#{_('One or more package names are invalid.')}',
      "validation_error_package_pending" : '#{_('One or more of the packages provided has an action pending.')}',
      "validation_error_group_pending" : '#{_('One or more of the groups provided has an action pending.')}',

      "x_of_y_packages" : function(x,y){ return '#{_("(Loaded %X of %Y Total)")}'.replace("%X", x).replace("%Y", y); }
      });

= javascript :filtertable, :form, :system_packages

= content_for :title do
  #{@system.name}

= content_for :navigation do
  = render_navigation(:items => systems_navigation, :expand_all => true, :level => 1)

= content_for :content do
  -#.grid_8.summary
    -#.summary_top
      -#.packages_icon
      -#.fl
        -#= image_tag("boxshadow.png")
      -#.summary_text.fl #{_("All Packages are up-to-date.")}

  - if packages.length > 0
    .grid_8
      = render :partial => "common/filter_table", :locals => {:filter_placeholder => _('Filter on loaded packages...')}
      = form_tag system_system_packages_path(@system.id), :id => "packages_form", :method => "post", :remote => true do
        %table.filter_table.packages.ajaxScroll{'data-system_id' => @system.id, 'data-total_packages' => total_packages}
          %thead
            %th{:colspan => 3}
              %a#package_sort{"data-sort"=>"asc", :class=>"ascending"}
                #{_("Name")}
            -#%th
              -##{_("Date Added")}
          %tbody
            -if editable
              %tr.no_sort.not_filtered
                %td{:colspan => 4}
                  %div#content_type
                  = radio_button_tag :perform_action, :packages, true
                  = label_tag _('Packages')
                  = radio_button_tag :perform_action, :package_groups, false
                  = label_tag _('Package Groups')

              %tr#error_message_container
                %td{:colspan => 4}
                  %div#error_message.validation_error_text

              %tr#content_form_row.no_sort.not_filtered
                %td{:colspan => 4}
                  %div#content_form
                    - help_text = _("Enter Selected Content...")
                    %input{:type=>'text', :id=>'content_input', :size=>'30', :placeholder => help_text, :title => help_text}
                    %a#add_content{:style => 'padding-left: 10px;'} #{_('+ Add')}
                    %a#remove_content{:style => 'padding-left: 10px;'} #{_('- Remove')}

            = render :partial => 'package_items', :locals => {:package_tasks => package_tasks, :group_tasks => group_tasks,
                                                              :packages => packages}

      #list-spinner
        = image_tag("spinner.gif", :class=>"ajax_scroll")

  - else
    %p There are no packages to display.

= content_for :footer do
  .grid_8
    %a#more{:style => "padding-left: 20px;", "data-scroll_url"=>url_for(more_packages_system_system_packages_path(@system.id)), "data-page_size"=>current_user.page_size, "data-offset"=>offset, :class=>"fl"} #{_("Load %{n} More" % {:n => offset})}
    %span{:id => 'loaded_summary', :style => "padding-left: 20px;"}
      -##{"%{n} Loaded of %{t} Total" % {:n => offset, :t => total_packages}}

    - if editable
      .prefix_2.grid_6.ra
        = submit_tag _("Update All"), :class => 'button', :id => 'update_all_packages', 'data-url' => system_system_packages_path(@system.id)
        = submit_tag _("Update"), :class => 'button', :id => 'update_packages', 'data-url' => system_system_packages_path(@system.id)
        = submit_tag _('Remove'), :class => 'button', :id => 'remove_packages', 'data-url' => remove_system_system_packages_path(@system.id)
