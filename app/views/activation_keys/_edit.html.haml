= javascript :edit_helpers, :activation_key_edit

= javascript do
  :javascript
    localize({
      "edit_environment": '#{_('Edit Environment')}'
    });

= content_for :title do
  #{_("Activation Key")}

= content_for :remove_item do
  - if editable
    = link_to _("Remove Activation Key"), activation_key_path(@activation_key.id), :confirm => _('Are you sure?'), :method => :delete, :class=>"remove_item", :remote=>true

= content_for :navigation do
  = render_navigation(:expand_all => true, :level => 3)

= content_for :content do
  = help_tip_button('activation_keys_edit-help')

  %input#panel_element_id{:name => @activation_key.id, :type => "hidden", :value => "#{name}_#{@activation_key.id}", "data-ajax_url"=>activation_key_path(@activation_key.id)}
  %input#system_templates{ :type => "hidden", :value => @system_templates_json }
  %input#system_templates_temp{ :type => "hidden" }

  #activation_key
    = hidden_field_tag 'environment_id', @activation_key.environment_id

    .grid_10
      = help_tip(_("Edit Activation Key enables you to modify the selected activation key.  This key may " + |
                 "be used during system registration.  For example, <BR/><BR/>" + |
                 "subscription-manager register --org #{@activation_key.organization.name} " + |
                 "--activationkey #{@activation_key.name}"), 'activation_keys_edit-help') |

    .grid_10
      = form_for @activation_key, activation_key_path(@activation_key), :method => "put", :remote => true do |f|
  
        %fieldset.clearfix
          .grid_2.ra
            %label #{_("Name")}:
          .grid_7.la#activation_key_name{'name' => 'activation_key[name]', :class => ("editable edit_panel_element" if editable), 'data-url' => activation_key_path(@activation_key.id)} #{@activation_key[:name]}

        %fieldset.clearfix
          .grid_2.ra
            %label #{_("Description")}:
          .grid_7.la#activation_key_description{:style => "word-wrap: break-word;", 'name' => 'activation_key[description]', :class => ("editable edit_textarea" if editable), 'data-url' => activation_key_path(@activation_key.id)}<> #{@activation_key[:description]}

        .promotion_paths
          %label #{_("Select an Environment")}:
          - unless current_organization.environments.empty?
            - current_organization.promotion_paths.each do |path|
              .jbreadcrumb
                %ul#env{:style => 'display: none', :class => ("edit_env_setup" if editable), 'data-env_url' => edit_environment_activation_key_path(@activation_key)}
                  %li
                    = link_to _('Locker'), "#", :class => (editable ? "crumb-editable" : "crumb-nohover")
                  - for env in path
                    %li
                      - if @activation_key.environment_id == env.id
                        %a.selected{'data-env_id' => env.id, :class => (editable ? "crumb-editable-selected" : "crumb-nohover-selected")}
                          %div
                            #{env.name}
                      - else
                        %a{'data-env_id' => env.id, :class => (editable ? "crumb-editable" : "crumb-nohover")}
                          %div
                            #{env.name}
              .clear
                &nbsp;

        %fieldset.clearfix
          .grid_2.ra
            %label #{_("System Template")}:
          .grid_7.la{'name' => 'activation_key[system_template_id]',  :class => ("editable edit_system_template" if editable), "data-url" => activation_key_path(@activation_key.id)} #{@system_template.nil? ? no_template : @system_template[:name]}
