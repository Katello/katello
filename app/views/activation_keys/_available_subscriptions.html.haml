= javascript :filtertable, :activation_key_subscriptions, :edit_helpers

= content_for :title do
  #{_("Activation Key")}

= content_for :remove_item do
  %a.remove_item.remove_key{"data-id"=>@activation_key.id ,"data-url"=>activation_key_path(@activation_key.id), "data-confirm-text"=>_('Are you sure?')}
    = _("Remove Activation Key")

= content_for :navigation do
  = render_navigation(:expand_all => true, :level => 3)

= content_for :content do
  #subscriptions
    .grid_10
      .fl
        - for env in @activation_key.environment.full_path
          - if env != @activation_key.environment
            #{env.name} >
          - else
            %strong #{env.name}
            - break
      .fr
        = render :partial => "common/filter_table"
    .grid_10.lower_content.clear
      = form_tag available_subscriptions_activation_key_path(@activation_key), :id=>"sub_form", :method=>"post", :remote=>true do
        %table.filter_table
          %thead
            %tr
              %th #{_("Subscription")}
              %th #{_("Type")}
              %th #{_("Start Date")}
              %th #{_("End Date")}
          %tbody
            - if available_subs.length > 0
              - available_subs.each do |sub_id, sub|
                %tr
                  %td
                    %span.fl
                      = check_box_tag "subscription_id[#{sub.poolId}]", false
                    &nbsp;
                    #{sub.name}
                  %td TODO type
                  %td #{sub.startDate}
                  %td #{sub.endDate}
            - else
              %tr
                %td{:colspan=>5} #{_("There are no more subscriptions available.")}
        - if editable && available_subs.length > 0
          .actions
            = submit_tag _('Add to Key'), :class => 'submit dialogbutton', :id=>"sub_submit"
            %a{:class=>'dialogbutton button disabled', :id=>"fake_sub_submit"} #{_('Add to Key')}