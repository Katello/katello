%div#dialog_content{:style => "word-wrap: break-word;"}

.grid_16
  = help_tip_button
  = help_tip(_("User notifications lists all notifications generated by a user as well as global notifications that are sent to all users."))   |

.grid_10
  %h2
    = _("User Notifications")

.top_bar
  = link_to _("Delete All"), {:action => "destroy_all", :controller => "notices"}, :method => :delete, :confirm => _('Are you sure?'), :class=>'deletable', :remote => true
  %form.fr#search_form.search{"data-url" => search_index_path()}
    = text_field_tag(:search, params[:search], {:type => "text", :placeholder => "Filter..."})
    %button.action{:form => "search_form"} #{_("Search")}

.grid_16
  %table.notifications
    %thead
      %th
        = sortable "created_at", _("Created (UTC)")
      %th
        = sortable "level", _("Level")
      %th
        = _("Organization")
      %th
        = _("Description")
    %tbody#notification_list
      - for notice in @notices
        - if notice.details.nil?
          %tr{:class => "#{notice.level}"}
            %td #{format_time(DateTime.parse(notice.created_at))}
            %td #{notice.level}
            %td #{notice.organization}
            %td
              = "#{notice.text}".html_safe
        - else
          %tr.details{:id => "#{notice.id}", :class => "#{notice.level}", 'data-url' => notices_details_path(notice.id)}
            %td #{format_time(DateTime.parse(notice.created_at))}
            %td #{notice.level}
            %td #{notice.organization}
            %td
              %div.details-icon.fr
              = "#{notice.text}".html_safe

= javascript :notices
