#
# WARNING: THIS CONFIGURATION WAS GENERATED BY KATELLO-CONFIGURE TOOL,
# CHANGES WILL LIKELY BE OVERWRITTEN.
#

# Katello configuration
#
# :vim:sw=2:ts=2:et:

# see /usr/share/katello/config.katello_defaults.yml for available options

common:
  app_mode: <%= scope.lookupvar("katello::params::deployment") %>

  warden:  <%= scope.lookupvar("katello::params::auth_method") %>
  ldap_roles: <%= scope.lookupvar("katello::params::ldap_roles") %>
  rest_client_timeout: 120

  url_prefix: /<%= scope.lookupvar("katello::params::deployment_url") %>
  host: <%= has_variable?("fqdn") ? fqdn : hostname %>
  port:
  use_ssl: true
  use_foreman: <%= scope.lookupvar("katello::params::use_foreman") %>

  post_sync_url: http://localhost:5000/<%= scope.lookupvar("katello::params::deployment_url") %>/api/repositories/sync_complete

  candlepin:
    url: <%= scope.lookupvar("katello::params::candlepin_url") %>
    oauth_key: <%= scope.lookupvar("katello::params::oauth_key") %>
    oauth_secret: <%= scope.lookupvar("katello::params::oauth_secret") %>

  pulp:
    url: <%= scope.lookupvar("katello::params::pulp_url") %>
    oauth_key: <%= scope.lookupvar("katello::params::oauth_key") %>
    oauth_secret: <%= scope.lookupvar("katello::params::oauth_secret") %>

  foreman:
    url: <%= scope.lookupvar("katello::params::foreman_url") %>
    oauth_key: <%= scope.lookupvar("katello::params::foreman_oauth_key") %>
    oauth_secret: <%= scope.lookupvar("katello::params::oauth_secret") %>

  cloud_forms:
    oauth_key: <%= scope.lookupvar("katello::params::oauth_key") %>
    oauth_secret: <%= scope.lookupvar("katello::params::oauth_secret") %>

<%- unless scope.lookupvar("katello::params::proxy_url") == "NONE" -%>
  cdn_proxy:
    host: <%= scope.lookupvar("katello::params::proxy_url") %>
    port: <%= scope.lookupvar("katello::params::proxy_port") unless scope.lookupvar("katello::params::proxy_port") == "NONE" %>
    user: <%= scope.lookupvar("katello::params::proxy_user") unless scope.lookupvar("katello::params::proxy_user") == "NONE" %>
    password: <%= scope.lookupvar("katello::params::proxy_pass") unless scope.lookupvar("katello::params::proxy_pass") == "NONE" %>
<%- end -%>

  database:
    username:
    password:

<%# bug #7991 in puppet 2.6 - need to explicitly load custom functions %>
<% Puppet::Parser::Functions::function('katello_passencrypt') %>

production:
  database:
    username: <%= scope.lookupvar("katello::params::db_user") %>
    password: <%= scope.function_katello_passencrypt([scope.lookupvar("katello::params::db_pass")]) %>
    database: <%= scope.lookupvar("katello::params::db_name") %>
